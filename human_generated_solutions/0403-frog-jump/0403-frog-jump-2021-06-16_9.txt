class Solution:
    def canCross(self, stones: List[int]) -> bool:
        if stones[1] != 1: return False
        loc = set(stones)
        
        @cache
        def fn(x, step): 
            """Return True if it is possible to cross river at stones[i]."""
            if x == stones[-1]: return True 
            ans = False 
            for ss in (step-1, step, step+1): 
                if 0 < ss and x + ss in loc: ans = ans or fn(x + ss, ss)
            return ans 
        
        return fn(1, 1)