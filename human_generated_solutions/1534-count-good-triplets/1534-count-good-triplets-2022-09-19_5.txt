class Solution:
    def countGoodTriplets(self, arr: List[int], a: int, b: int, c: int) -> int:
        
        # insert function to insert the value in the list after checking if the value is greater than present elements in the list
        def insrt(lst, val):
            i = 0
            while i < len(lst):
                if val <= lst[i]:
                    break
                i += 1
            lst.insert(i, val)
        
        # res is the var to return the count of good triples
        out = 0
        
        # a new list to store the previous good doubles arr[i] and arr[j]
        left = [arr[0]]
        
        # another list to store the previous good doubles arr[j] and arr[k]
        right = sorted(arr[2:])
        
        # loops through the array for the difference values for a, b, c
        for j in range(1, len(arr) - 1):
            
            # necessary variables to count the number of good doubles for a
            #usage of left array
            left_start, left_end = 0, len(left) - 1
            left_down = arr[j] - a    ####  arr[i] = a + arr[j]
            left_up = arr[j] + a      #### -(arr[j]) = a - arr[i]
            
            # these loops iterate over the array and counts number of values for a
            while left_start <= left_end and left[left_start] < left_down:
                left_start += 1
            while left_start <= left_end and left[left_end] > left_up:
                left_end -= 1
                
            # necessary variables to count the number of good doubles for b
            #usage of right array
            right_start, right_end = 0, len(right) - 1
            right_down = arr[j] - b    ####    arr[j] = b + arr[k]
            right_up = arr[j] + b      ####   -(arr[k]) = a - arr[j]
            
            # these loops iterate over the array and counts number of values for b
            while right_start <= right_end and right[right_start] < right_down:
                right_start += 1
            while right_start <= right_end and right[right_end] > right_up:
                right_end -= 1

            # conditional statement for obtaining the values of c
            if left_start <= left_end and right_start <= right_end:
                
                # necessary variables to count the number of good doubles for c
                k_start, k_end = right_start, right_start
                
                # another final loop to iterate over both the lists so that we can find the values for c
                for i in range(left_start, left_end + 1):
                    k_down = left[i] - c   ####    arr[i] = c + arr[k]
                    k_up = left[i] + c     ####   -(arr[k]) = c - arr[i]
                    
                    while k_start <= right_end and right[k_start] < k_down:    
                        k_start += 1
                    while k_end <= right_end and right[k_end] <= k_up:
                        k_end += 1
                    
                    # counts the number of good triples from the lists and indices we have used so far
                    if k_start < k_end:
                        out += k_end - k_start  
                
            # inserts arr[j] at its position in non-decreasing order
            insrt(left, arr[j])
            
            # removes the unnecessary element which cannot be one of the good triple
            right.remove(arr[j + 1])

        return out