class Solution:
    def minKBitFlips(self, nums: List[int], k: int) -> int:
        
        # How many time have we flipped?
        count = 0
        # How many past flips have ended?
        unwind = 0
        # We cannot flip past this point:
        max_flip = len(nums)-k+1
        
        # nums[i] is overwritten as we go, because we never revisit past elements.
        #
        # (count - unwind) is the number of "active" flips
        #
        # (count - unwind) % 2 == 0 means we are currently not flipping elements
        
        for i in range(len(nums)):
            
            # A flip endeding now was performed at i-k
            if i >= k and nums[i-k]:
                unwind += 1
            
            # Do we need to flip the current element?
            if (nums[i] + count - unwind) % 2 == 0:
                # We can\'t flip because we are close to the end.
                if i >= max_flip:
                    return -1
                # Excute the flip
                count += 1
                # Signal the flip location
                nums[i] = 1
            else:
                # Signal a non-flip location
                nums[i] = 0
                
        return count