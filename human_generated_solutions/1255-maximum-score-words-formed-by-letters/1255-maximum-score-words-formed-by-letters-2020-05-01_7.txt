class Solution(object):
    def maxScoreWords(self, words, letters, score):
        """
        :type words: List[str]
        :type letters: List[str]
        :type score: List[int]
        :rtype: int
        """
        total={} # store frequency of all characters in letters
        for i in letters:
            if i in total:
                total[i]+=1
            else:
                total[i]=1
        a=[] # stores freqency of all charcters in words
        for i in words:
            d={}
            for j in i:
                if j in d:
                    d[j]+=1
                else:
                    d[j]=1
            a.append(d)
        def sol (count,n):
            if n==-1:
                return 0
            if sum(count.values())==0:
                return 0
            pos=1 # to check if adding current element is possible or not
            for i in a[n]:
                if i in count:
                    if count[i]<a[n][i]:
                        pos=0
                        break
                else:
                    pos=0 
                    break
            if pos==0:
                return sol(count,n-1)
            else:
                x=dict(count)
                s=0
                for i in a[n]:
                    s+=a[n][i]*score[ord(i)-97] # calculate score by adding current string
                    x[i]-=a[n][i] # uptade the count
                return max(sol(count,n-1),sol(x,n-1)+s)
        ans=sol(total,len(a)-1)
        return (ans)