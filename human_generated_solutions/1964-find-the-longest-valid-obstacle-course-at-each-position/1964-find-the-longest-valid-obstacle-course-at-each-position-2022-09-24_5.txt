class Solution(object):
    def longestObstacleCourseAtEachPosition(self, obstacles):
        """
        :type obstacles: List[int]
        :rtype: List[int]
        """
        lo = len(obstacles)
        longestSeq = [obstacles[0]]
        def binarySearch(arr, target):
            left = 0
            right = len(arr)
            while left < right:
                mid = (left+right)//2
                if arr[mid] <= target:
                    left = mid+1
                else: 
                    right = mid
                
            return right  
        lengths = [1]*lo
        for i in range(1, lo):
            if obstacles[i] >= longestSeq[-1]:
                longestSeq.append(obstacles[i])
                lengths[i] = len(longestSeq)
            else: #elif obstacles[i] < longestSeq[-1]:
                idx = binarySearch(longestSeq, obstacles[i])
                longestSeq[idx] = obstacles[i]
                lengths[i] = idx+1
            
        return lengths