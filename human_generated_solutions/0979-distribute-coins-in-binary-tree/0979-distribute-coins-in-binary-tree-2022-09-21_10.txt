class Solution:
    def distributeCoins(self, root: Optional[TreeNode]) -> int:
        ans = 0
        
        def solve(root):
            if not root:
                return 0
            
            left = solve(root.left)
            right = solve(root.right)
            total = left + right
            
            if root.val >= 1:
                total += root.val - 1
            else:
                total -= 1
            
            nonlocal ans
            ans += abs(total)
            return total
        
        solve(root)
        return ans