class Solution:
    def largestComponentSize(self, nums: List[int]) -> int:
        graph=defaultdict(list)
        n=len(nums)
        def find_prime_factors(n):
            factors=[]
            mmax=ceil(sqrt(n))+1
            for i in range(2,mmax):
                if n%i==0:
                    factors.append(i)
                    while n%i==0:
                        n//=i
                if n==1: break
            if n>1: factors.append(n)
            return factors
        for i,num in enumerate(nums):
            arr=find_prime_factors(num)
            for factor in arr: graph[factor].append(i)
        parent=[i for i in range(n)]
        def find(x):
            if parent[x]!=x:
                parent[x]=find(parent[x])
            return parent[x]
        def union(x,y):
            u,v=find(x),find(y)
            if u!=v:
                parent[v]=u
        count=[0]*n
        for factor,arr in graph.items():
            for i in range(len(arr)-1):
                union(arr[i],arr[i+1])
        for i in range(n):
            x=find(i)
            count[x]+=1
        return max(count)