class Solution:
    def minStoneSum(self, piles: List[int], k: int) -> int:
        idx = max(piles)
        count = [0] * (idx + 1)
        for x in piles:
            count[x] += 1
        while k > 0 and idx >= 0:
            if not count[idx]:
                idx -= 1
            num = min(count[idx], k)
            count[idx] -= num
            count[(idx + 1) // 2] += num
            k -= num
        return sum((i * x for i, x in enumerate(count)))