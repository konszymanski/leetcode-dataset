import collections
class Solution:
    def maxResult(self, nums, k):
        n = len(nums)
        # store the max value in each index of nums
        dp = [nums[0]] * n 
        # store the index of maximum dp values inside a window of k
        mono_dec_q = collections.deque([0]) 
        for i in range(1, n):
            # the first value in queue is maximum
            dp[i] = nums[i] + dp[mono_dec_q[0]] 
            # when iterate to dp[i], if it is higher than the end of queue, delete the end
            while mono_dec_q and dp[i] >= dp[mono_dec_q[-1]]: 
                mono_dec_q.pop()
            # if index out of window, slide the window to the right
            if mono_dec_q and i - mono_dec_q[0] == k:
                mono_dec_q.popleft()
            mono_dec_q.append(i)
        return dp[-1]