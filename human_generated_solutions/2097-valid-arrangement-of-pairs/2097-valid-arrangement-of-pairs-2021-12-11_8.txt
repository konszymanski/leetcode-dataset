from array import array
class Solution:
    def validArrangement(self, pairs: List[List[int]]) -> List[List[int]]:
        graph = defaultdict(lambda: array(\'I\'))
        degree = defaultdict(int) # net out degree 
        # swapping x, y enables us to avoid reversing our final path 
        for y, x in pairs:
            graph[x].append(y)
            degree[x] += 1 # technically out_degree(x) is implicitly stored in len(graph[x]) 
            degree[y] -= 1
        stack = array(\'I\', [next((k for k in graph if degree[k]==1), x)])
        while (l := graph[stack[-1]]):  # unroll one iteration to initialize prev
            stack.append(l.pop())
        prev = stack.pop()
        while stack:
            while (l := graph[stack[-1]]):
                stack.append(l.pop())
            yield (prev, (prev := stack.pop()))