class Solution:
    def union(self, i: int, j: int):
        self.parent[i] = j        
        
    def find(self, i: int):
        if self.parent[i] == i:
            return i
        return self.find(self.parent[i])
    
    def backtrack(self, i: int, k: int):
        if self.inCurrentCyclees[i]:
            for j in reversed(self.currentCyclees):
                if j != i:
                    self.union(j, i)
                else:
                    break
        else:
            self.currentCyclees.append(i)
            self.inCurrentCyclees[i] = True
            for j in self.graph[i]:
                if j != k and self.find(j) != self.find(i):
                    self.backtrack(j, i)
            self.currentCyclees.pop()
            self.inCurrentCyclees[i] = False
    
    def criticalConnections(self, n: int, connections: List[List[int]]) -> List[List[int]]:
		# build graph
        self.graph = defaultdict(set)
        for a, b in connections:
            self.graph[a].add(b)
            self.graph[b].add(a)
		
		# find strongly connected components
        self.currentCyclees, self.inCurrentCyclees = [], [False] * n 
        self.parent = [i for i in range(n + 1)]
        self.backtrack(0, n)
        
		# identify critical connections
        toReturn = []
        for i in range(n):
            for j in self.graph[i]:
                if i < j and self.find(j) != self.find(i):
                    toReturn.append([i, j])
                    
        return toReturn