class DSU:
    def __init__(self, N):
        self.parent = [i for i in range(N)]
        self.rank = [1] * N
        self.components = N

    def find(self, x):
        if self.parent[x] != x:
            self.parent[x] = self.find(self.parent[x])
        return self.parent[x]

    def union(self, a, b):
        ua = self.find(a)
        ub = self.find(b)
        if ua == ub:
            return False

        if self.rank[ua] < self.rank[ub]:
            ua, ub = ub, ua

        self.parent[ub] = ua
        self.rank[ua] += self.rank[ub]
        self.rank[ub] = self.rank[ua]
        self.components -= 1
        return True


class Solution:
    def numSimilarGroups(self, strs: List[str]) -> int:
        
        def areSimilar(a, b):
            diff = 0
            for i in range(len(a)):
                if a[i] != b[i]:
                    diff += 1            
            return diff <= 2
        
        N = len(strs)
        uf = DSU(N)
        
        for i in range(N):
            for j in range(i + 1, N):
                if areSimilar(strs[i], strs[j]):
                    uf.union(i, j)
        return uf.components
    # Time: O(N^2 * M * \u03B1(N)) where M is the length of the longest word in strs and N is the length of strs
    # Space: O(N)