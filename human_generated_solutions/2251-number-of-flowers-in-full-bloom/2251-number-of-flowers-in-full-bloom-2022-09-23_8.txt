class Solution:
    def fullBloomFlowers(self, flowers: List[List[int]], persons: List[int]) -> List[int]:
        #len(flowers)=n, len(persons)=m
        
        n = len(flowers)
        
        #O(mlogm)
        persons = sorted(enumerate(persons), key=lambda x: x[1])
        active = [] #To keep track of current bloom flowers
        ans = [0]*len(persons)
        
        #O(nlogn)
        flowers.sort(reverse=True)
        
        #O(m + 2*(nlogn))
        for index,p_arrival_time in persons:
            
            #To add end time of flowers interval where start time is lesser or equal to current persons arrival time
            while(flowers and flowers[-1][0]<=p_arrival_time):
                start,end = flowers.pop()
                heapq.heappush(active,end)
            
            #To remove end times of bloomed flowers from active for which end time has passed w.r.t current persons arrival time
            while(active and active[0]<p_arrival_time):
                heapq.heappop(active)
            
            #Length of active will contain bloomed flowers w.r.t current persons arrival time
            ans[index] = len(active)
        
        return ans