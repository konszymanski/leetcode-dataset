from heapq import heappush, heappop

class Solution:
    def fullBloomFlowers(self, flowers: List[List[int]], persons: List[int]) -> List[int]:
        out = [0 for _ in range(len(persons))]
        persons = [(arrival, i) for i, arrival in enumerate(persons)]
        persons.sort()
        flowers.sort()

        heap = []
        f_idx = 0
        for arrival, person_idx in persons:
            while f_idx < len(flowers) and flowers[f_idx][0] <= arrival:
                heappush(heap, flowers[f_idx][1])
                f_idx += 1
            while len(heap) and heap[0] < arrival:
                heappop(heap)
            out[person_idx] = len(heap)
        return out