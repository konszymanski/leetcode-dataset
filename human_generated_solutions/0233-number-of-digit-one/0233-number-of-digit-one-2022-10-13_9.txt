class Solution:
    def countDigitOne(self, n: int) -> int:

        @cache
        def dp(pos, tight, ones):
            if pos >= N:
                return ones
            
            ans = 0
            upperLimit = A[pos] if tight else 9
            for d in range(upperLimit + 1):
                tight2 = tight and d >= upperLimit
                ans += dp(pos + 1, tight2, ones + (d == 1))
            return ans
        
        A = list(map(int, str(n)))
        N = len(A)
        return dp(0, True, 0)
    # Time: O(m^2) where m is the number of digits of n, which is roughly log(n) --> Time: O((log(n))^2)
    # Time: O(m)