class Solution:
    def findAllPeople(self, n: int, meetings: List[List[int]], firstPerson: int) -> List[int]:

        
        def bfs_spread_secret(secret_holder, talk_network, secret_spreading_nodes):
            
            # keep spreading secret by BFS if we still have secret spreading nodes
            while secret_spreading_nodes:
                
                # pop and get one secret spreader
                cur_secret_spreader = secret_spreading_nodes.pop()

                # scan each person who talked to current secret spreader
                for another_person in talk_network[cur_secret_spreader]:
                    
                    if another_person not in secret_holder:
                        
                        # update secret holder and spreading nodes
                        secret_holder.add(another_person)
                        secret_spreading_nodes.add(another_person)
                            
            return        
        
        # -------------------------------------------------------------------
        
        # secret source given by description
        SECRET_SOURCE = 0
        
        # initialization for secret holder
        secret_holder = set([SECRET_SOURCE, firstPerson])
        
        
        # keep meetings sorting on time stamp with ascending order
        meetings.sort(key=lambda m:m[2])
        
        # record of timestamp for BFS
        prev_time = -1
        
        ## dictionary:
        # key: person index
        # value: a set of index to those people who talk to specific person
        talk_network = defaultdict(set)
        
        ## set:
        # a set of index of those people who become secret spreader after meeting with secret holder
        secret_spreading_nodes = set()
        
        
        # scan person pair in each meeting
        for person_a, person_b, time in meetings:
            
            
            # keep updating talk network until reaching next time stamp
            if time != prev_time:
                
                bfs_spread_secret(secret_holder, talk_network, secret_spreading_nodes)
                
                # clear talk network and secret spreading nodes for next time stamp
                talk_network.clear()
                secret_spreading_nodes.clear()
            
            
            # update talk network in each meeting
            talk_network[person_a].add(person_b)
            talk_network[person_b].add(person_a)
            
            # update secret spreading nodes from secret holder in each meeting
            if person_a in secret_holder:
                secret_spreading_nodes.add(person_a)

            if person_b in secret_holder:
                secret_spreading_nodes.add(person_b)
                        
                
            # update time stamp
            prev_time = time
        
        
        # final BFS update
        bfs_spread_secret(secret_holder, talk_network, secret_spreading_nodes)
        

        # unpack secret_holder from python set to python list
        return [*secret_holder]