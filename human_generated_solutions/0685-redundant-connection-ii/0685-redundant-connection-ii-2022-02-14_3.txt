class Solution:
    def findRedundantDirectedConnection(self, edges: List[List[int]]) -> List[int]:
        def find(x):
                if parent[x]!=x:
                    parent[x]=find(parent[x])
                return parent[x]
            
        def union(x,y):
            x,y=find(x),find(y)
            if x!=y:
                parent[y]=x
                return True
            return False
        
        n=len(edges)
        in_degree=[0]*(n+1)
        flag=False
        for u,v in edges:
            if in_degree[v]:
                to,a,b=v,in_degree[v],u       #node_with_2_parents,first_parent,second_parent by order of edges
                flag=True
                break
            else: in_degree[v]=u
        parent=[i for i in range(n+1)]
        #case:1
        if not flag:
            for u,v in edges:
                if not union(u,v):
                    return [u,v]
		#case 2 && 3
        else:
            remove=b
            edges.remove([b,to])
            for u,v in edges:
                if not union(u,v):
                    return [a,to]
            return [b,to]