class Solution:
    def maxTotalFruits(self, fruits, start, steps):
        prefix_sum = [0]
        for _, count in fruits:
            prefix_sum.append(prefix_sum[-1] + count)

        maximum = 0

        for i, (position, _) in enumerate(fruits):
            remaining = steps - abs(start - position)
            if remaining >= 0:
                if position < start:
                    finish = max(position + remaining, start)
                    j = bisect_left(fruits, [finish, inf])
                    if j == len(fruits) or fruits[j][0] > finish:
                        j -= 1
                    maximum = max(maximum, prefix_sum[j + 1] - prefix_sum[i])
                else:
                    finish = min(position - remaining, start)
                    j = bisect_left(fruits, [finish, 0])
                    if fruits[j][0] < finish:
                        j += 1
                    maximum = max(maximum, prefix_sum[i + 1] - prefix_sum[j])

        return maximum