class Solution:
    def averageOfSubtree(self, root: Optional[TreeNode]) -> int:
        
        def fn(node): 
            nonlocal ans
            if not node: return 0, 0 
            ls, ln = fn(node.left)
            rs, rn = fn(node.right)
            s = node.val + ls + rs
            n = 1 + ln + rn
            if s//n == node.val: ans += 1
            return s, n
        
        ans = 0 
        fn(root)
        return ans