# Definition for a binary tree node.
# class TreeNode:
#     def __init__(self, val=0, left=None, right=None):
#         self.val = val
#         self.left = left
#          self.right = right
class Solution:
    def countPairs(self, root: TreeNode, d: int) -> int:
        
        def check(node,l,ans):
            if node==None:
                return []
            
            if node.left==None and node.right==None:
                k=[]
                k.append(l)
                return k
            
            lr=check(node.left,l+1,ans)
            rr=check(node.right,l+1,ans)
            
            #print(lr,rr)
            for x in lr:
                for z in rr:
                    if x-l+z-l<=d:
                        ans[0]+=1
            return lr+rr
                
            
        
        
        ans=[0]
        check(root,0,ans)
        return ans[0]