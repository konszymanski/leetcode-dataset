class Solution:
    def addOneRow(self, root: TreeNode, v: int, d: int) -> TreeNode:
        if d == 1: return TreeNode(v, left=root) # edge case 
        
        def fn(node, d): 
            if d == 1: 
                node.left = TreeNode(v, left=node.left)
                node.right = TreeNode(v, right=node.right)
            if node.left: node.left = fn(node.left, d-1)
            if node.right: node.right = fn(node.right, d-1)
            return node 
        
        return fn(root, d-1)