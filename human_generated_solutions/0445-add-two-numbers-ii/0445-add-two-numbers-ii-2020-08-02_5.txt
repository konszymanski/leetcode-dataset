class Solution:
    
    def addTwoNumbers(self, l1: ListNode, l2: ListNode) -> ListNode:
        len1 = self._getLength(l1)
        len2 = self._getLength(l2)
        
        head, carry = self._addRecursively(l1, len1, l2, len2)
        
        if carry:
            head = ListNode(carry, head)
            
        return head
    
    def _addRecursively(self, l1: ListNode, len1: int, l2: ListNode, len2: int) -> ListNode:
        if not l1 and not l2:
            return (None, 0)
        
        current_sum = 0
        carry = 0
        
        if len1 > len2:
            head, carry = self._addRecursively(l1.next, len1 - 1, l2, len2)
            current_sum = l1.val + carry
        elif len1 < len2:
            head, carry = self._addRecursively(l1, len1, l2.next, len2 - 1)
            current_sum = l2.val + carry
        else:
            head, carry = self._addRecursively(l1.next, len1 - 1, l2.next, len2 - 1)
            current_sum = l1.val + l2.val + carry
            
        carry = current_sum // 10
        current_sum %= 10
        
        return (ListNode(current_sum, head), carry)

    def _getLength(self, l: ListNode) -> int:
        result = 0
        curr = l
        
        while curr:
            curr = curr.next
            result += 1
            
        return result