class Solution:
    def numFriendRequests(self, ages: List[int]) -> int:
        # in a sense: "bucket sort"
        ageMax = max(ages)
        ageBuckets = [0]*(ageMax+1)
        for age in ages:
            ageBuckets[age] += 1
        
        # build cumulative sum
        ageCum = [ageBuckets[0]]*(ageMax+1)
        for i in range(1,len(ageBuckets)):
            ageCum[i] = ageCum[i-1] + ageBuckets[i]
            
        # main logic
        ans = 0
        for age in range(1,len(ageBuckets)):
            if ageBuckets[age]:
                k = int(age * 0.5 + 7)
                if k < age:
                    ans += ageBuckets[age] * (ageCum[age-1] - ageCum[k])
                if age > k:
                    ans += ageBuckets[age]*(ageBuckets[age]-1)
            
        return ans