from collections import defaultdict
class Solution:
    def equationsPossible(self, equations: List[str]) -> bool:
        count=0
        def def_val():
            return []
        dic=defaultdict(def_val)
        notequals = []
        for i in range(len(equations)):
            a=equations[i][0]
            b=equations[i][-1]
            relation = equations[i][1:3]
            if(relation=="!="):
                notequals.append([a, b])
                continue
            if(a==b):
                continue
            else:
                if(a not in dic):
                    dic[a]=[b]
                    if(b in dic):
                        dic[b].append(a)
                    else:
                        dic[b]=[a]
                if(a in dic):
                    flag=False
                    for j in dic[a]:
                        if(j[0]==b):
                            flag=True
                    if(not flag):
                        dic[a].append(b)
                    if(b in dic):
                        flag=False
                        for j in dic[b]:
                            if(j[0]==a):
                                flag=True
                        if(not flag):
                            dic[b].append(a)
                    else:
                        dic[b]=[a]
        # print(dic)
        def isConnected(x,y):
            src=x
            stack = [x]
            # print(x)
            visited = set()
            while(stack):
                curr = stack.pop()
                visited.add(curr)
                for v in dic[curr]:
                    if(v not in visited):
                        stack.append(v)
            if(y in visited):
                return True
            else:
                return False
        for i in range(len(notequals)):
            x, y = notequals[i]
            if(x==y or isConnected(x,y)):
                return False
        return True