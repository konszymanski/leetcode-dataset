class Solution:
    def countArrangement(self, n: int) -> int:
        #bitvector[i] tells weather or not nums[i+1] is used
        #slot represents the position to be filled in the permutation str we are building
        @cache
        def solve(bitvec,slot):
            
            if bitvec == (1<<n)-1:
                return 1
            
            count = 0
            #try every possible number for the \'slot\'th slot
            for i in range(1,n+1):
                if (bitvec & 1<<i-1 == 0) and (i%slot==0 or slot%i==0):
                    count += solve(bitvec|1<<i-1,slot+1)
                    
            return count
        
        return solve(0,1)