class Solution:
    def maxSubarraySumCircular(self, nums: List[int]) -> int:
        
        n=len(nums)
        ans=nums[0]
        heap=[(0,-1)]
        pre=0
        
        for i in range(2*n):
            pre+=nums[i%n]
            while heap and i-heap[0][1]>n:
                heappop(heap)
            
            ans=max(ans,pre-heap[0][0])
            heappush(heap,(pre,i))
        
        return ans