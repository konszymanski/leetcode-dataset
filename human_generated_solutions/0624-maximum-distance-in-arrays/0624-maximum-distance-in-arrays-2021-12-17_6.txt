class Solution:
    def maxDistance(self, arrays: List[List[int]]) -> int:
        minimum_val, maximum_val, max_so_far = float(\'inf\'), -float(\'inf\'), 0
        
        for i, array in enumerate(arrays):
            min_val, max_val = array[0], array[-1]
            max_so_far = max(max_so_far, max_val - minimum_val, maximum_val - min_val)
            minimum_val, maximum_val = min(minimum_val, min_val), max(maximum_val, max_val)
            
        return max_so_far