class Solution:
    def makeConnected(self, n: int, connections: List[List[int]]) -> int:
        
        if len(connections) < n - 1: return -1
        
        def DO_DFS(isVisited, graph, node):
            stack = [node]
            while stack:
                vertices = stack.pop()
                if vertices not in isVisited:
                    isVisited.add(vertices)
                    
                    for vertex in graph[vertices]:
                        if vertex not in isVisited:
                            stack.append(vertex)
        
        graph = [ set() for _ in range(n) ]
        
        for u, v in connections:
            graph[u].add(v)
            graph[v].add(u)
            
        isVisited = set()
        disconnectedSubGraph = 0
        
        for node in range(n):
            if node not in isVisited:
                disconnectedSubGraph += 1
                DO_DFS(isVisited, graph, node)
                
        return disconnectedSubGraph - 1