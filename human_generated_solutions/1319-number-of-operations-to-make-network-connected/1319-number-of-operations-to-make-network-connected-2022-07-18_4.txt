class Solution:
    def makeConnected(self, n: int, a: List[List[int]]) -> int:
        length = len(a)
        if length < n - 1:
            return -1
        nodes = set()
        connections = defaultdict(list)
        
        for src,dest in a:
            connections[src].append(dest)
            connections[dest].append(src)
        
        def dfs(src):
            if src in nodes:
                return
            nodes.add(src)
            for node in connections[src]:
                dfs(node)
            
        
        result = 0
        for i in range(n):
            if i not in nodes:
                dfs(i)
                result+=1
        
        return result - 1