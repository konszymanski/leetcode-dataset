from collections import namedtuple
from collections import defaultdict
import heapq

# NamedTuples make code more readable.
Point = namedtuple(\'point\',[\'x\', \'y\'])
Building = namedtuple("building",[\'left\',\'right\',\'height\'])
# heap entry, height is negative
Rooftop = namedtuple(\'rooftop\',[\'height\',\'rightEnd\'])

class Solution: 
    def getSkyline(self, buildings: List[List[int]]) -> List[List[int]]:
        # Named tuple conversion.
        buildings = [Building(*b) for b in buildings]
        
        # Build a list of transition points where a building either begins or ends.
        transitions: List[int] = [ b.left for b in buildings ] + [b.right for b in buildings]
		# Deduplicate and sort.
        transitions = sorted(list(set(transitions)))
                
        # left -> building
        buildDict: Dict[int, Building] = defaultdict(set)
        for b in buildings:
            buildDict[b.left] |= {b}
        
        roofHeap: List[Rooftop] = []
        out: List[Point] = []
        lastHeight: int = 0
        
		# Iterate through building transition points.
        for x in transitions:
            # Add new rooftops that start at this transition point.
            for b in buildDict[x]:
                # heapq only supports minheap, so use negative height for maxheap.
                rooftop = Rooftop(-b.height, b.right)
                heapq.heappush(roofHeap, rooftop)
            
            # Remove rooftop at root of heap if the rooftop\'s right end is before the current transition point.
            while roofHeap and roofHeap[0].rightEnd <= x:
                throwaway = heapq.heappop(roofHeap)
            
            # Add a point if the heaproot height is different from previous height.
            maxHeight = 0
            if roofHeap:
                # Negate to extract max from minheap.
                maxHeight = -roofHeap[0].height
            if maxHeight != lastHeight:
                lastHeight = maxHeight
                p = Point(x, maxHeight)
                out.append(p)
                
        return out