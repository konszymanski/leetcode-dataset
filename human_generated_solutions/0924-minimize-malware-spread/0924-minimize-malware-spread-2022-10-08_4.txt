class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        parent, numNodes = [0] * len(graph), len(graph)
        for node in range(numNodes):
            parent[node] = node
        
        def find(node: int) -> int:
            if node == parent[node]:
                return node
            parent[node] = find(parent[node])
            return parent[node]
        
        for node1 in range(numNodes):
            for node2 in range(node1 + 1, numNodes):
                if graph[node1][node2] == 1:
                    parent[find(node1)] = find(node2)
        infectedNodeCount, nodeCount = [0] * numNodes, [0] * numNodes
        for node in initial:
            infectedNodeCount[find(node)] += 1
        for node in range(numNodes):
            nodeCount[find(node)] += 1
        initial.sort()
        maxNodesSaved, res = 0, initial[0]
        for initialNode in initial:
            if infectedNodeCount[parent[initialNode]] == 1 and nodeCount[parent[initialNode]] > maxNodesSaved:
                maxNodesSaved, res = nodeCount[parent[initialNode]], initialNode
        return res