class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        
        adj = defaultdict(list)
        for i in range(len(graph)):
            for j in range(len(graph)):
                if i == j:
                    continue
                
                if graph[i][j] == 1:
                    adj[i].append(j)
        
        node_infected = {}
        node_infect_count = [0 for i in range(len(graph))]
        for node in initial:
            # do bfs
            queue = deque([node])
            cur_infected = set()
            while queue:
                cur_node = queue.popleft()
                
                if cur_node in cur_infected:
                    continue
                cur_infected.add(cur_node)
                
                for next_node in adj[cur_node]:
                    queue.append(next_node)
                    
            for infected_node in cur_infected:
                node_infect_count[infected_node] += 1
                
            node_infected[node] = cur_infected
        
        initial.sort() # avoid the index coming in random order
        min_ind = float(\'-inf\')
        max_removal = float(\'-inf\')
        for node in initial:
            count = 0
            for infected_node_id in node_infected[node]:
                if node_infect_count[infected_node_id] == 1:
                    count += 1
            
            if count > max_removal:
                max_removal = count
                min_ind = node
                
        return min_ind