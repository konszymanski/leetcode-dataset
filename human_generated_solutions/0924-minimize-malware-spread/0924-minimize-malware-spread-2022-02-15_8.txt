class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        def find(x):
            if x!=parent[x]:
                parent[x]=find(parent[x])
            return parent[x]
        def union(x,y):
            u,v=find(x),find(y)
            if u!=v: 
                parent[v]=u
        n=len(graph)
        initial=set(initial)
        ans=sys.maxsize
        mmin=sys.maxsize
        for i in initial:
            parent=[t for t in range(n)]
            rank=[0]*n
            temp=set([j for j in initial])
            temp.remove(i)
            for x in range(n):
                for y in range(x+1,n):
                    if graph[x][y]==1:
                        if find(x) in temp:
                            union(x,y)
                        else:
                            union(y,x)
            val=sum(1 for o in range(n) if find(o) in temp)
            if val<=mmin:
                if (val==mmin and i<ans) or (val<mmin):
                    mmin=val
                    ans=i
        return ans