from collections import Counter
from itertools import product
from typing import List


class Solution:
    def fourSumCount(self, A: List[int], B: List[int], C: List[int], D: List[int]) -> int:
        """
        @see https://leetcode.com/problems/4sum-ii/discuss/93920/Clean-java-solution-O(n2)/150111

        Let n = len(A) = len(B) = len(C) = len(D) and we want i, j, k and l such that,
                            A[i] + B[j] + C[k] + D[l] = 0 and 0 <= i, j, k, l < n
        or,
                            A[i] + B[j] = -C[k] - D[l]

        for every pair (C[k], D[l]) we want to find if A[i] + B[j] exists such that
        the above condition holds. This is done by having a hashmap.
        
        :param A:
        :param B:
        :param C:
        :param D:
        :return:
        """
        cnt = Counter(-a - b for a, b in product(A, B))
        return sum(cnt[c + d] for c, d in product(C, D))