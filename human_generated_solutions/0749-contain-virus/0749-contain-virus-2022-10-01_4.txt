class Solution:
    def containVirus(self, isInfected: List[List[int]]) -> int:

        # return number of walls needed
        def dfs(r, c):

            # return
            if (r, c) in visited or r < 0 or c < 0 or r >= m or c >= n:
                return 0

            # contained cells
            if isInfected[r][c] == -1:
                return 0
            
            # uninfected cells
            if isInfected[r][c] == 0:
                risky.add((r, c))
                return 1
            
            # infected cells
            visited.add((r ,c))
            walls = 0
            if isInfected[r][c] == 1:
                walls += dfs(r+1, c)
                walls += dfs(r-1, c)
                walls += dfs(r, c+1)
                walls += dfs(r, c-1)

            return walls
        
        m, n = len(isInfected), len(isInfected[0])
        total_wall = 0

        while True:
            # store (len(risky), risky, wall, starting points)
            gettingInfected = []
            visited = set()
            for i in range(m):
                for j in range(n):
                    if isInfected[i][j] == 1 and isInfected[i][j] not in visited:
                        risky = set()
                        w = dfs(i, j)
                        gettingInfected.append((-len(risky), risky, w, i, j))

            
            # heapy the gettingInfectious array to get the max len of risky
            heapq.heapify(gettingInfected)

            if not gettingInfected or gettingInfected[0][2] == 0:
                return total_wall

            # mark the infected cells as contained starting from (i, j)
            lr, risky, w, i, j = heapq.heappop(gettingInfected)
            # maybe a dfs for marking the cells?
            queue = collections.deque([(i, j)])
            while queue:
                r, c = queue.pop()
                if r < 0 or c < 0 or r >= m or c >= n or isInfected[r][c] != 1:
                    continue

                isInfected[r][c] = -1

                queue.append((r+1, c))
                queue.append((r-1, c))
                queue.append((r, c+1))
                queue.append((r, c-1))

            # increment the total walls
            total_wall += w
            for area in gettingInfected:
                riskyCells = area[1]
                for cell in riskyCells:
                    r, c = cell
                    isInfected[r][c] = 1