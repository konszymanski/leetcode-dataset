from functools import lru_cache
class Solution:
    def numMusicPlaylists(self, n: int, goal: int, k: int) -> int:
        # recurrence relation is sol(n, goal) = (1) + (2)
        # (1) sol(n-1, goal-1) * (N - (n-1))[this represents we can add any song from remaining (N - (n-1)) songs if we have] (N is total distinct songs we have originally)
        # (2) sol(n, goal-1) * (n-k) [we can take any songs other than last k songs]
        @lru_cache(None)
        def sol(i, j):
            if i == 0 and j == 0:
                # we can create an empty playlist
                return 1
            if i == 0 and j>0:
                # we cant create any playlist of length greater than 0 without any songs
                return 0
            if j == 0 and i>0:
                # we can have playlist with 0 songs in it. but as the number of songs are > 0 and we need to have them atleast once. so, no such playlist is possible
                return 0
            
            return (sol(i-1, j-1) * (n - (i-1)) + sol(i, j-1) * max(0, i - k))%(10**9 + 7)
        
        
        return sol(n, goal)