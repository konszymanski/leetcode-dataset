class Solution:
    def longestPath(self, parent: List[int], s: str) -> int:
        children = collections.defaultdict(list)
        for i, p in enumerate(parent):
            children[p].append(i)

        max_length = 1
        def dfs(idx):
            nonlocal max_length
            if idx not in children: return 1
            
            first, second = 0, 0
            for child in children[idx]:
                curr = dfs(child)
                if s[idx]!=s[child]:
                    if curr > first:
                        second = first
                        first = curr
                    elif curr > second:
                        second = curr

            max_length = max(max_length, first+second+1)
            return first+1

        dfs(0)
        return max_length