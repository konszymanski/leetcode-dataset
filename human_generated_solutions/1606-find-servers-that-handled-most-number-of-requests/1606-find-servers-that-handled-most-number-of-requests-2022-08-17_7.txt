class Solution:
    def busiestServers(self, k: int, arrival: List[int], load: List[int]) -> List[int]:
        
        available = list(range(k)) 
        busy = [] 
        result = [0] * k
        
        for index, come in enumerate(arrival):
            while busy and busy[0][0] <= come: 
                _, free = heapq.heappop(busy)
                heapq.heappush(available, index + (free - index) % k) 
            if available: 
                assigned = heapq.heappop(available) % k
                heapq.heappush(busy, (come + load[index], assigned))
                result[assigned] += 1
        
        Max = max(result)
        return [i for i in range(k) if result[i] == Max]
    
    """
    Maintan two priority queues. AVAILABLE and BUSY. 
    Take for example, input as k = 3; arrival = [1,2,3,4,5]; load = [5,2,3,3,3]
    Initialize AVAILABLE with (0, 1, 2).
    Push the servers into BUSY when tasks are assigned. 
    In this example, you assign 0th item to server 0 (0 % 3).
    1st item to server 1 (1 % 3).
    2nd item to server 2 (2 % 3).
    At this stage, AVAILABLE is empty. BUSY = [(4, 1), (6, 0), (6, 1)]
    When you are inserting 3rd item with load 3, you need to assign it to 
    (3 % 3) = 0th server. However, you can pop ony 1st server at this time. So, you
    have to assign it to first server.
    The expression, index + (free - index) % k does this.
    Here, index = 3. free = 1. index + (free - index) % 3 = 3 + (-2) % 3.
    That is, 3 + 1 = 4.
    This 4 is pulled out the the priority queue as 4 % 3 = 1.
    That is , we are saying server 0 is busy, add it one. 
    This is exacly what the expression index + (free - index) % k does.
    
    Now, assume even 1 was not available, and server 2 is available. 
    index = 3. free = 2. index + (free - index) % k = 3 + (2 - 3) % 3
    3 + (-1) % 3 = 3 + 2 = 5.
    When you pull this 5 out of the queue, you do 5 % 3 = 2. 
    That is, you are adding the task to server 2.
    
    """