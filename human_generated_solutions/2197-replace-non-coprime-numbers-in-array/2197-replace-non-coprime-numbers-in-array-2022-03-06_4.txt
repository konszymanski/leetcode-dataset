class Solution:
    def replaceNonCoprimes(self, nums: List[int]) -> List[int]:
        i = 0
        queue = deque(nums)
        # [2, 7, 2, 14]
        # [2, 7, 14]
        # [2, 14]
        # [14]
        
        # Need a better way to mark
        # to traverse between two
        # This would be much easier if this is a list
        class ListNode():
            def __init__(self, val, prev=None, nxt=None):
                self.val = val
                self.next = nxt
                self.prev = prev
                
        h = ListNode(nums[0])
        curr = h
        for n in nums[1:]:
            ln = ListNode(n, curr, None)
            curr.next = ln
            curr = ln
        
        # Now traverse the list
        curr = h
        prev = h
        # Note that only one the change may occur is to one before it.
        # So... if changed: traverse backward
        while curr:
            if curr.next and math.gcd(curr.val, curr.next.val) > 1:
                # Replaces this and next with a new list node
                curr.val = math.lcm(curr.val, curr.next.val)
                if curr.next.next:
                    curr.next.next.prev = curr
                curr.next = curr.next.next
                if curr.prev is not None:
                    curr = curr.prev
            else:
                curr = curr.next
        curr = h
        out = []
        while curr:
            out.append(curr.val)
            curr = curr.next
        return out