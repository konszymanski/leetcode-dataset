class Solution:
    def findMinHeightTrees(self, n: int, edges: list[list[int]]) -> list[int]:
        """
        @see https://leetcode.com/problems/minimum-height-trees/solution/
        :param n:
        :param edges:
        :return:
        """
        if n <= 2:
            return list(range(n))

        g = self.create_graph(n, edges)

        leaves = [u for u, nbrs in enumerate(g) if len(nbrs) == 1]
        remaining_nodes = n

        while remaining_nodes > 2:
            remaining_nodes -= len(leaves)

            new_leaves = []

            for u in leaves:
                v = g[u].pop()
                (v_nbrs := g[v]).remove(u)

                if len(v_nbrs) == 1:
                    new_leaves.append(v)

            leaves = new_leaves

        return leaves

    @staticmethod
    def create_graph(n, edges: list[list[int]]) -> list[set[int]]:
        """
        :param n: total number of nodes in graph
        :param edges:
        :return: list of sets, item at index i is set of neighbors of ith node
        """
        g = [set() for _ in range(n)]

        for u, v in edges:
            g[u].add(v)
            g[v].add(u)

        return g