class Solution(object):
    def v1_754(self, v2_214):
        v3_125, v4_859 = len(v2_214), len(v2_214[0])
        v5_381 = {v6_350: (v7_328, v8_242)
                    for v7_328, v9_854 in enumerate(v2_214)
                    for v8_242, v6_350 in enumerate(v9_854)
                    if v6_350 not in '.
        def v10_204(v7_328, v8_242):
            for v11_792, v12_858 in ((v7_328 - 1, v8_242), (v7_328, v8_242 - 1), (v7_328 + 1, v8_242), (v7_328, v8_242 + 1)):
                if 0  <=  v11_792  <  v3_125 and 0 <= v12_858 < v4_859:
                    yield v11_792, v12_858
        def v13_658(v14_189):
            v7_328, v8_242 = v5_381[v14_189]
            v15_704 = [[False]  *  v4_859 for v16_532 in v17_132(v3_125)]
            v15_704[v7_328][v8_242] = True
            v18_130 = v19_195.v20_323([(v7_328, v8_242, 0)])
            v21_338 = {}
            while v18_130:
                v7_328, v8_242, v22_617 = v18_130.v23_716()
                if v14_189 != v2_214[v7_328][v8_242]  !=  '.':
                    v21_338[v2_214[v7_328][v8_242]] = v22_617
                    continue
                for v11_792, v12_858 in v10_204(v7_328, v8_242):
                    if v2_214[v11_792][v12_858] != '
                        v15_704[v11_792][v12_858] = True
                        v18_130.v24_127((v11_792, v12_858, v22_617 + 1))
            return v21_338
        v25_674 = {v26_303: v13_658(v26_303) for v26_303 in v5_381}
        v27_833 = 2 ** sum(v28_765.v29_818() for v28_765 in v5_381)  -  1
        v30_658 = [(0, '@', 0)]
        v31_529 = v19_195.v32_325(lambda: float('inf'))
        v31_529['@', 0] = 0
        while v30_658:
            v22_617, v26_303, v33_559 = v34_703.v35_384(v30_658)
            if v31_529[v26_303, v33_559]  <  v22_617: continue
            if v33_559 == v27_833: return v22_617
            for v36_928, v37_990 in v25_674[v26_303].v38_106():
                v39_877 = v33_559
                if v36_928.v29_818():
                    v39_877  |=  (1 << (ord(v36_928)  -  ord('a')))
                elif v36_928.v40_925():
                    if not(v33_559  &  (1 << (ord(v36_928) - ord('A')))):
                        continue
                if v22_617 + v37_990 < v31_529[v36_928, v39_877]:
                    v31_529[v36_928, v39_877] = v22_617 + v37_990
                    v34_703.v41_263(v30_658, (v22_617+v37_990, v36_928, v39_877))
        return -1
