class Solution:
    def flatten(self, head: \'Node\') -> \'Node\':
        def dfs(head):
            cur = prev = head
            while cur:
                if cur.child: 
                    cur.child.prev, curnext, cur.next, cur.child = cur, cur.next, cur.child, None
                    cur = dfs(cur.next)
                    cur.next = curnext
                    if cur.next:
                        cur.next.prev = cur
                cur, prev = cur.next, cur
            return prev         
        dfs(head)
        return head