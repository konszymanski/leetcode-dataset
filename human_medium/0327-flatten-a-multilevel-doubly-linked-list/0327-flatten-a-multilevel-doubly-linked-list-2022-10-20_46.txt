class Solution:
    def flatten(self, head: \'Optional[Node]\') -> \'Optional[Node]\':
        if head == None: return head
        temp = head
        result, wip = [], [head]
        while len(wip) > 0:
            temp = wip.pop(0)
            while temp:
                result.append(temp)
                if temp.child:
                    if temp.next: wip.insert(0,temp.next)
                    temp = temp.child
                else: temp = temp.next
        result[0].prev, result[-1].next = None, None
        for i in range(len(result)-1):
            result[i].next = result[i+1]
        for i in range(len(result)-1,0,-1):
            result[i].prev = result[i-1]
        for i in result: i.child = None
        return result[0]