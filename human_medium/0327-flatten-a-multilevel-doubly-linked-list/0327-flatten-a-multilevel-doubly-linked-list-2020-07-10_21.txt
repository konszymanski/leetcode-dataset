class Solution:
    def flatten(self, head: \'Node\') -> \'Node\':
        
        if not head:
            return head
        
        # Keep running until meeting child or end
        runner = head
        while not runner.child and runner.next:
            runner = runner.next
        
        if not runner.child:
            return head
        
        # Store flattened node.next as tail
        # Replace node.next with flattened child
        tail, runner.next = self.flatten(runner.next), self.flatten(runner.child)
        runner.child = None
        runner.next.prev = runner
        
        # Let runner run to the end
        while runner.next:
            runner = runner.next
        
        # Append tail to end
        if tail:
            runner.next = tail
            runner.next.prev = runner
        
        return head