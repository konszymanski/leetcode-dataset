class Solution:
    def flatten(self, head: \'Optional[Node]\') -> \'Optional[Node]\':
        def _flatten(node, tail):
            if not node:
                return tail
            
            node.next = _flatten(node.child, _flatten(node.next, tail))
            node.child = None
            
            if node.next:
                node.next.prev = node

            return node
        return _flatten(head, None)