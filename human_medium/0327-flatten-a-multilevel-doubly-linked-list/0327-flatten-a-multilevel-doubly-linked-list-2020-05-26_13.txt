class Solution:
    def flatten(self, head: \'Node\') -> \'Node\':
        
        def fn(node): 
            """Recursively flatten doubly-linked list."""
            if not node: return 
            tail = node
            if node.child: 
                tail = fn(node.child)
                tail.next = node.next 
                if node.next: node.next.prev = tail
                node.next = node.child
                node.child.prev = node
                node.child = None
            return fn(node.next) or tail
        
        fn(head)
        return head