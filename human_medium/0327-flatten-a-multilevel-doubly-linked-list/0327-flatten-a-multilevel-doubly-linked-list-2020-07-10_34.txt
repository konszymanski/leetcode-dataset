class Solution:
    def flatten(self, head: \'Node\', next_=None) -> \'Node\':
        curr, prev = head, None
        while curr:
            if curr.child:
                tail = curr.next
                curr.next = self.flatten(curr.child, tail)
                if curr.next: curr.next.prev = curr
                curr.child = None
            prev = curr
            curr = curr.next
        if prev:  prev.next = next_
        if next_: next_.prev = prev
        return head