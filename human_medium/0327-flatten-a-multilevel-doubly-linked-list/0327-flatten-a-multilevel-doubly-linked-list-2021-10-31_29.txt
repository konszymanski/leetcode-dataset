class Solution(object):
    def flatten(self, head):
        """
        :type head: Node
        :rtype: Node
        """
        nodes = []

        def dfs(node):
            nodes.append(node)
            if node.child:
                dfs(node.child)
            if node.next:
                dfs(node.next)

        if head == None: return None
        
        dfs(head)
        
        for i in range(len(nodes)):
            nodes[i].next = nodes[i+1] if i+1 < len(nodes) else None
            nodes[i].prev = nodes[i-1] if i-1 >= 0 else None
            nodes[i].child = None

        return nodes[0]