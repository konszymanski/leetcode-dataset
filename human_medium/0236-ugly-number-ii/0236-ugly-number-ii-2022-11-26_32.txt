import heapq

class Solution:
    def nthUglyNumber(self, n: int) -> int:
        # the latest ugly number found; start with 1 to deal with edge case n = 1
        x = 1

        # L1: ugly numbers that haven\'t been multiplied by 2 to generate a new number
        # L2: by 3
        # L3: by 5   
        L1, L2, L3 = [1], [1], [1]
        
        # set of ugly numbers generated
        ugly_nums = set([1])

        # generate new ugly number from the min of L1*2, L2*3, L3*5
        while len(ugly_nums) < n:
            x = min([L1[0] * 2, L2[0] * 3, L3[0] * 5])

            # pop the respective parent number out of the heap b/c it\'s used 
            if x == L1[0] * 2: heapq.heappop(L1)
            elif x == L2[0] * 3: heapq.heappop(L2)
            else: heapq.heappop(L3)

            # if the ugly number is a new one, push it into heaps & add to set
            if x not in ugly_nums:
                for h in [L1, L2, L3]:
                    heapq.heappush(h, x)
                ugly_nums.add(x)

        # return the latest ugly number found once we\'ve found n of them
        return x