class Solution(object):
    def maxProfit(self, prices):
        N = len(prices)
        dp = [[0]*N for i in range(3)] #0 cool 1 buy 2 sell
        dp[0][0], dp[1][0], dp[2][0] = 0, -prices[0], 0
        
        for i in range(1, N):
            dp[0][i] = max(dp[0][i-1], dp[2][i-1]) #cool
            dp[1][i] = max(dp[0][i-1]-prices[i], dp[1][i-1]) #buy
            dp[2][i] = max(dp[2][i-1]-prices[i-1]+prices[i], dp[1][i-1]+prices[i]) #sell
        return max([dp[i][-1] for i in range(3)])