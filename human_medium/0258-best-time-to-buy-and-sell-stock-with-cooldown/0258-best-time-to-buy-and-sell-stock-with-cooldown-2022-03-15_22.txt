class Solution:
    def maxProfit(self, prices: List[int]) -> int:
        
        #Our dp structure will be a cache that will hold max profit depending on the criteria
        #of the key
        #dp Key = (index of prices, Boolean Value of whether or not we can buy or sell)
        dp = {}
        
        #We\'ll do a top down memoized solution. We\'re passing into our dfs function the
        #current Index and whether or not we\'re buying
        def dfs(i, canBuy):
            
            #If we\'ve come to the end of the prices array
            if i >= len(prices):
                #We\'re just going to return 0
                #This base case is basically saying that if we only have the last number 
                #In the prices array, we\'re going to return 0 because we have nothing to sell
                #So a cooldown this day will lead to max profit
                return 0
            
            #If we\'ve seen this key before we just return dp
            if(i, canBuy) in dp:
                return dp[(i, canBuy)]
            
            #If we can buy
            if canBuy:
                #We either buy the current stock
                #We can\'t buy the next stock too so we say canBuy = False
                bought = dfs(i + 1, False) - prices[i]
                
                #Or we do a cooldown and wait a day to buy
                cooldown = dfs(i + 1, True)
                
                #We add to dp which ever gives us a bigger value
                dp[(i, canBuy)] = max(bought, cooldown)
            
            #If we can sell
            else:
                #We either sell the current stock
                #We skip a day to simulate a cooldown day so we input i + 2
                #We can now buy the next stock
                sold = dfs(i + 2, True) + prices[i]
                
                #Or we do a cooldown and wait a day to sell
                cooldown = dfs(i + 1, False)
                
                #We add to dp which ever gives us a bigger value
                dp[(i, canBuy)] = max(sold, cooldown)
                
            #We return the current dp value
            return dp[(i, canBuy)]

        #We return the start index and say canBuy = True, becauase we can\'t sell a stock
        #We don\'t own
        return dfs(0, True)