class Solution:
    #  simple maths formula to calculate number of possible slices, given 
    #  a slice of length \'n\'
    def calculate(self, n):
        return (n * (n + 1)) // 2
        
    def numberOfArithmeticSlices(self, A: List[int]) -> int:
        #  Dictionary which keeps track of the number of occurrences of ezch arithmetic slice
        #  Note that the longest possible slice is taken at a time
        h = defaultdict(int)
        if len(A) < 3:
            return 0
        #  \'start\' keeps track of the starting index of each slice
        start = 0
        diff = A[1] - A[0]
        for i in range(2, len(A)):
            curr = A[i] - A[i - 1]
            if curr != diff:
                #  if slice is possible, increase its frequency
                if i - start >= 3:
                    h[i - start] += 1
                #  modify \'start\' and \'diff\'
                start = i - 1
                diff = curr
            else:
			    #  handling a slice ending at the last index of the array
                if i == len(A) - 1 and i - start + 1 >= 3:
                    h[i - start + 1] += 1
        res = 0
        for key, value in h.items():
            res += value * self.calculate(key - 2)
        return res