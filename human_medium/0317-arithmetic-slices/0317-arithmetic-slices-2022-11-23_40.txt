class Solution:
    def numberOfArithmeticSlices(self, nums: List[int]) -> int:
        def getSubarray(num):  # calculates the number of subarrays with length >= 3
            return int(((num - 3 + 1) + 1) * (num - 3 + 1) / 2 )
			# the above line is the same logic as:
            # res = 0
            # count = 3  # consider only subarray longer than or equal to 3
            # while num - count >= 0:
            #     res += num - count + 1  # number of subarrays that has length num-count
            #     count += 1
            # return res
        
        if len(nums) < 3:
            return 0
        ptr1 = 0  # start of the subarray 
        ptr2 = 1  # end of the subarray
        res = 0
        diff = nums[ptr2] - nums[ptr1]
        while ptr2 < len(nums) - 1:
            if nums[ptr2 + 1] - nums[ptr2] == diff:  # the next element is part of the longest subarray
                ptr2 += 1
            else:
                diff = nums[ptr2 + 1] - nums[ptr2]
                if ptr2 + 1 - ptr1 >= 3:  # qualified longest subarray, add all its subarrays  
                    res += getSubarray(ptr2 + 1 - ptr1)
                ptr1 = ptr2
                ptr2 += 1
        if ptr2 + 1 - ptr1 >= 3:
            res += getSubarray(ptr2 + 1 - ptr1)
        return res