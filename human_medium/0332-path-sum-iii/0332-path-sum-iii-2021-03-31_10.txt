class Solution {
public:
    unordered_map<int, int> times;
    int count = 0;
    void solve(TreeNode* root, int curr_sum, int sum){
        if(root == NULL) return;
        curr_sum += root->val;
        count += times[curr_sum - sum];
        times[curr_sum]++;
        solve(root->left, curr_sum, sum);
        solve(root->right, curr_sum, sum);
        times[curr_sum]--;
        return;
    }
    
    int pathSum(TreeNode* root, int sum) {
        times[0] = 1;
        solve(root, 0, sum);
        return count;
    }
};