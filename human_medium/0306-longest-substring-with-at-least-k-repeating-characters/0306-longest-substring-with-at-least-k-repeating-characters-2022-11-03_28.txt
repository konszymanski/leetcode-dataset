class Solution:
    def longestSubstring(self, s: str, k: int) -> int:
        
        # longest substring s
        #
        #   --> the *frequency* of each character in this substring is greater than or equal to k
        #
        #   Example a:
        #    "aabbc" K=2 
        #      if all of s is considered -> hashmap {a:2, b:2, c:1} Not good, because c:1 is lower than 2
        #
        #   Example b:
        #    "aacbb" K=2  <-- How do we find it?
        #
        #   Brute Force : sweep s by window length 1, 2, 3, .... , len(s)  O(len(s)^2)
        #   Hashmap will help to find it. For first case, we need to avoid character "c"
        #   
        #   Idea -> Add info to strings
        #      avoid character : 0
        #      count character : 1
        #   Then
        #    "aacbb" K=2
        #     11011
        #   (*)Start counting from index 0. If we encounter 0, set count as 0 and keep counted number if maximum
        #
        #   Example c:
        #    "ababacb"  K=3
        #     1111101
        #
        #   First idea does not work in example c. The next strategy is fragment of string by 0.
        #   Then, sweep fragmented text and create count again.
        #  
        #   Time : O(NlogN) ?
        #   Space : ?
        
        from collections import Counter
        
        def fragment_string( string, longest ) :
            
            frequency = Counter( string )
            if min(frequency.values())>=k :
                longest = max( longest, len(string) )
                return longest
            
            # split string
            stack = []
            for c in string :
                if frequency[c]>=k :
                    stack.append(c)
                else :
                    if len(stack)>0 :
                        longest = fragment_string( "".join(stack), longest )
                        stack = []
            if len(stack)>0 :
                longest = fragment_string( "".join(stack), longest )
            
            return longest
        
        return fragment_string( s, 0 )