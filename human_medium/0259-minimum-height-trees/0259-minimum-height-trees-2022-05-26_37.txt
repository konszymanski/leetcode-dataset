class Solution:
    def findMinHeightTrees(self, n: int, edges: List[List[int]]) -> List[int]:
        if n == 1:
            return [0]
        
        graph = collections.defaultdict(set)
        indegree = collections.Counter({i: 0 for i in range(n)}) # keep number of edges for each node
        depths = collections.defaultdict(set) # distance from leaves: set(nodes)
        
        for a, b in edges: # build graph and indegree from edges list
            graph[a].add(b)
            indegree[b] += 1
            graph[b].add(a)
            indegree[a] += 1
        
        # initialize queue with leaf nodes and their depth. The original leaf nodes have indegree = 1 and depth 0
        depth = 0
        queue = collections.deque([(node, depth) for node in indegree if indegree[node] == 1])
        
        while queue:    
            node, depth = queue.popleft()
            
            if depth in depths:
                depths[depth].add(node)
            else:
                depths[depth] = {node}
            
            for connected in graph[node]: # remove the current node from its connected node
                    
                graph[connected].remove(node)
                indegree[connected] -= 1
                
                if indegree[connected] == 1: # the connected node becomes a leaf
                    queue.append((connected, depth + 1))
                    
        # the node(s) with the max depth are the roots of minimum height trees
        return list(depths[depth])