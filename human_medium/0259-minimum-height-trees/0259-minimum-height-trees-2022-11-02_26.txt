class Solution:
    # O(n^2) solution using dfs and treating all nodes as roots for once
    def findMinHeightTrees(self, n: int, edges: List[List[int]]) -> List[int]:
        if n == 1: return [0]
        graph = defaultdict(list)
        nodes = set()
        for a, b in edges:
            nodes.add(a)
            nodes.add(b)
            graph[a].append(b)
            graph[b].append(a)
        dist = defaultdict(int)
        def dfs(node, parent, curr, visited):
            dist[parent] = max(dist[parent], curr)
            for nei in graph[node]:
                if nei not in visited:
                    visited.add(nei)
                    dfs(nei, parent, curr + 1, visited)
                    visited.discard(nei)
            
        for node in nodes:
            dfs(node, node, 0, {node})
        mini = min(dist.values())
        res = set()
        for k, v in dist.items():
            if v == mini:
                res.add(k)
        return res