class Solution(object):
    def findMinHeightTrees(self, n, edges):
        if len(edges) == 0:
            return [n-1]
        
        d = defaultdict(list)
        for start, end in edges:
            d[start].append(end)
            d[end].append(start)
        
        queue = []
        
        for key in d:
            if len(d[key]) == 1:
                queue.append(key) #take leaves
        
        while queue and len(d) > 2:
            newqueue = []
            while queue: #remove all current leaves
                pop = queue.pop()
                neighbour = d[pop][0]
                d[neighbour].remove(pop)
                if len(d[neighbour]) == 1:
                    newqueue.append(neighbour) #add new leaves
                del d[pop]
            queue = newqueue[:]
        
        return list(d.keys())