class Solution:
    def findMinHeightTrees(self, n: int, edges: List[List[int]]) -> List[int]:
        if n == 1:
            return [0]
            
        adjMap = {i:[] for i in range(n)}
        indegree = {i:0 for i in range(n)}
        
        for source1,source2 in edges:
            adjMap[source1].append(source2)
            adjMap[source2].append(source1)
            indegree[source1] += 1
            indegree[source2] += 1
        
        queue = collections.deque()
        for i in range(n):
            if indegree[i] == 1:
                queue.append(i)
        
        remainNodes = n
        while queue and remainNodes>2:
            for i in range(len(queue)):
                removed = queue.popleft()
                indegree[removed] -= 1
                remainNodes -= 1
                for child in adjMap[removed]:
                    indegree[child] -= 1
                    if indegree[child] == 1:
                        queue.append(child)            

        return list(queue)