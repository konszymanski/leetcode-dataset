class Solution:
    def findMinHeightTrees(self, n: int, edges: List[List[int]]) -> List[int]:
      dicts = {}
      for source, target in edges:
        if source not in dicts:
          dicts[source] = {target}
        else:
          dicts[source].add(target)
        if target not in dicts:
          dicts[target] = {source}
        else:
          dicts[target].add(source)
      
      mini_height = sys.maxsize
      res = []
      
      @lru_cache(None)
      def search(prev, current):
        temp_res = 1
        if prev == None:
          if current in dicts:
            for element in dicts[current]:
              temp_res = max(temp_res, search(current, element) + 1)
        else:
          if current in dicts:
            for element in dicts[current]:
              if element != prev:
                temp_res = max(temp_res, search(current, element) + 1)
        return temp_res
      
      for i in range(n):
        temp_res = search(None, i)
        if temp_res < mini_height:
          mini_height = temp_res
          res = [i]
        elif temp_res == mini_height:
          res.append(i)
        
      return res