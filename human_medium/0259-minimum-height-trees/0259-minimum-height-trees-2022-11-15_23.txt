class Solution:
    def findMinHeightTrees(self, n: int, edges: List[List[int]]) -> List[int]:
        if n == 1: return [0]
        adj = defaultdict(list)
        for i, j in edges:
            adj[i].append(j)
            adj[j].append(i)
        
        def backtracking(node, parenet, path, longestPath):
            if len(adj[node]) == 1 and adj[node][0] == parenet and len(path) > len(longestPath):
                return path.copy()
            for child in adj[node]:
                if child != parenet:
                    path.append(child)
                    longestPath = backtracking(child, node, path, longestPath)
                    path.pop()
            return longestPath
        node = backtracking(0, None, [0], [])[-1]
        path = backtracking(node, None, [node], [])
        return [path[(L := len(path)) // 2]] + ([path[L // 2 - 1]] if L % 2 == 0 else [])