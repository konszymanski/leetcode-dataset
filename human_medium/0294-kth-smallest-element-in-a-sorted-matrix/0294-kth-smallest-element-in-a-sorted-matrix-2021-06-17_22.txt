class Solution:
    def kthSmallest(self, matrix: List[List[int]], k: int) -> int:
        start, end = matrix[0][0], matrix[-1][-1]
        n, m = len(matrix), len(matrix[0])

        def getub(key):
            row, col, ubcount = n - 1, 0, 0
            while row >= 0 and col < m:
                root = matrix[row][col]
                if root > key:
                    row -= 1  # go to root.left
                else:  # root is <= key
                    col += 1  # go to root.right
                    ubcount += (row + 1)
                    # since sorted, by transitivity
                    # all els in&above this cell is <= key
                    # which is just row+1 number of elements
            return ubcount

        while start <= end:  # lb binary search loop
            mid = (start + end) >> 1
            ub = getub(mid)
            if ub < k:
                start = mid + 1
            else:
                end = mid - 1

        return start