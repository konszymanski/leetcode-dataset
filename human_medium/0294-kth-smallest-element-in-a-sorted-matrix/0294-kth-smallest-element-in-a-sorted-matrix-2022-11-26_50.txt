from heapq import heappush , heappop
class Solution:
    def check(self, A , n , val):
        count = 0
        for i in range(n):
            if A[i] <= val:
                count += 1
        return count
    def kthSmallest(self, matrix: List[List[int]], k: int) -> int:
        # using binary search in TC - O(nlogn) , SC - O(1)
        n , m = len(matrix) , len(matrix[0])
        low = matrix[0][0]
        high = matrix[n-1][m-1]
        
        while low < high:
            mid = low + (high - low) // 2   # calculate mid
            cnt = 0
            #iterate for each row and check if matrix has element
            # less than or greater than the mid
            for i in range(n):
                cnt += self.check(matrix[i] , m , mid)
            # count of element is less than k in the entire matrix
            # so check for larger number
            if cnt < k:
                low = mid + 1   
            else:       # check for smaller number
                high = mid
        
        return low  #low will contain the kth smallest element
        
        
        # using max heap of size k to find kth smallest element
        # TC - O(N2 LOG(K)) , SC - O(K)
        n , m = len(matrix) , len(matrix[0])
        heap = []

        for i in range(n):
            for j in range(m):
                heappush(heap , -matrix[i][j])

                if len(heap) > k:
                    heappop(heap)
        
        return -heap[0]