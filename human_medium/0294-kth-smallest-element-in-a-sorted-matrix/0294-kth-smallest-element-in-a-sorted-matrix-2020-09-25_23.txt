class Solution:
    def kthSmallest(self, matrix: List[List[int]], k: int) -> int:
        \'\'\'
        Runtime: 152 ms, faster than 100.00% of Python3 online submissions for Kth Smallest Element in a Sorted Matrix.
        Memory Usage: 19.9 MB, less than 20.98% of Python3 online submissions for Kth Smallest Element in a Sorted Matrix.
        \'\'\'
        n = len(matrix)
        l, r = matrix[0][0], matrix[-1][-1]
        ans = matrix[0][0]
        while l <= r:
            mid = (l+r) // 2
            count, num = self.helper(mid, matrix)
            if count >= k:
                ans = num
                r = mid - 1
            else:
                l = mid + 1
        return ans 
    
    def helper(self, mid, matrix):
        count = 0
        num = -float(\'inf\')
        for row in matrix:
            idx = bisect.bisect(row, mid)
            count += idx
            if idx > 0:
                num = max(num, row[idx-1])
        return count, num