class Solution:
    def rob(self, root: TreeNode) -> int:
        def postorder(root):
            if not root:
                return (0, 0)
            left_prev1, left_prev2 = postorder(root.left)
            right_prev1, right_prev2 = postorder(root.right)

            curr_prev2 = left_prev1 + right_prev1
            curr_prev1 = max(curr_prev2, root.val + left_prev2 + right_prev2)
            return curr_prev1, curr_prev2

        return postorder(root)[0]