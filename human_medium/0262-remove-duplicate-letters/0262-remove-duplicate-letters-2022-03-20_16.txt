class Solution:
    def removeDuplicateLetters(self, s: str) -> str:
        st, freq, vis = [], Counter(s), set()
        for ch in s:
            if ch in vis: 
                freq[ch]-=1
                continue
                
            while st and st[-1]>ch and freq[st[-1]]>1:
                freq[st[-1]]-=1
                vis.remove(st.pop())
            
            st.append(ch)
            vis.add(ch)
        
        return "".join(st)