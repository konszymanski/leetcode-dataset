class Solution:
    #ref: https://leetcode.com/problems/remove-duplicate-letters/discuss/1859515/Python-oror-O(n)-Beats-98-oror-Stack-oror-Detailed-Explanation-oror-Simple
    #T=O(n), S=O(1)
    #space complexity is O(26)
    def removeDuplicateLetters(self, s: str) -> str:
        #init stack, visited set
        stack = []
        visited = set()
        #create dict to track last index of each item
        #{c1: last_idx1, c2: last_idx2}
        last_occurence = { c: i for i, c in enumerate(s) }
        
        #iterate through string s
        for i, c in enumerate(s):
            #duplicates should be added
            if c not in visited:
                #edge case of empty stack
                #pop when top item of stack has ord() val greater than current char
                #monotonic increasing stack
                #pop only when top item of the stack appears in the future index of input string
                while stack and stack[-1] > c and last_occurence[stack[-1]] > i:
                    #pop the item and remove from visited set
                    #remove from set because it should be added again
                    val = stack.pop()
                    visited.remove(val)
                #append items on stack and set
                stack.append(c)
                visited.add(c)
        #return concatenated version of stack as a string
        return "".join(stack)