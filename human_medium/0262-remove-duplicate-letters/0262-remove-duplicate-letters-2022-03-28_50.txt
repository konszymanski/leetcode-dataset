class Solution:
    def removeDuplicateLetters(self, s: str) -> str:
        lower_bound, upper_bound = -1, len(s) - 1
        alphabet, result = set(s), {}
        while alphabet:
            seen, indices = set(), {}
            for i in range(upper_bound, lower_bound, -1):
                seen.add(char := s[i])
                if char not in result and seen >= alphabet:
                    indices[char] = i

            char, lower_bound = min(indices.items())
            result[char] = None
            alphabet.remove(char)

        return r\'\'.join(result)