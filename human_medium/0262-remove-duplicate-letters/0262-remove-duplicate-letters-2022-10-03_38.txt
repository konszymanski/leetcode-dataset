from collections import defaultdict
class Solution:
    def removeDuplicateLetters(self, s: str) -> str:
        find_last = defaultdict(int)
        
        # find the last index of each letter
        for i in range(len(s)):
            find_last[s[i]] = i
        
        # use stack
        stack = []
        seen = set()
        for ind, item in enumerate(s):
            if item not in seen:
                while stack and item < stack[-1] and ind < find_last[stack[-1]]:
                    seen.remove(stack.pop())
                stack.append(item)
                seen.add(item)
            
        return \'\'.join(stack)