class Solution:
    def removeDuplicateLetters(self, s: str) -> str:
        stack, last = [], {}
        for idx, char in enumerate(s):
            last[char] = idx 
        for idx in range(len(s)):
            if s[idx] in stack:
                continue
            while stack and stack[-1] > s[idx] and last[stack[-1]] > idx:
                stack.pop()
            stack.append(s[idx])
        return \'\'.join(stack)