class Solution:
    def minMutation(self, start: str, end: str, bank: List[str]) -> int:
        def are_neighbors(node1, node2):
            distance = 0
            for i in range(8):
                if node1[i] != node2[i]:
                    distance += 1
            return distance == 1
        neighbors = defaultdict(set)
        for node1 in bank + [start]:
            for node2 in bank + [start]:
                if are_neighbors(node1, node2):
                    neighbors[node1].add(node2)
        queue = deque([start])
        visited = set()
        steps = 0
        found = False
        while queue:
            nodes = []
            while queue:
                nodes.append(queue.popleft())
            for node in nodes:
                if node == end:
                    found = True
                    break
                for neighbor in neighbors[node]:
                    if neighbor not in visited:
                        visited.add(neighbor)
                        queue.append(neighbor)
            steps += 1
        return steps - 1 if found else -1