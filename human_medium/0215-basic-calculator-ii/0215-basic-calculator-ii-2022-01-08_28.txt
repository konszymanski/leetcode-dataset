class Solution:
    
    def iterate(self, s: str) -> Iterable[str]:
        digit_start = None
        for idx, c in enumerate(s):
            if c == " ":
                if digit_start is not None:
                    yield int(s[digit_start:idx])
                    digit_start = None
                continue
            if c in "-+*/":
                if digit_start is not None:
                    yield int(s[digit_start:idx])
                    digit_start = None
                yield s[idx]
                continue
            if digit_start is None:
                digit_start = idx
        if digit_start is not None:
            yield int(s[digit_start:])
    
    def calculate(self, s: str) -> int:
        res = 0
        vals = iter(self.iterate(s))
        partial = next(vals)
        partial_op = "+"
        while True:
            try:
                op = next(vals)
                val = next(vals)
                if op == "*":
                    partial *= val
                elif op == "/":
                    partial //= val
                elif partial_op == "+":
                    res += partial
                    partial_op = op
                    partial = val
                else:
                    res -= partial
                    partial_op = op
                    partial = val
            except StopIteration:
                break
        if partial_op == "+":
            res += partial
        else:
            res -= partial
        return res