class Solution:
    def addTwoNumbers(self, l1: Optional[ListNode], l2: Optional[ListNode]) -> Optional[ListNode]:
        if not l1:
            return l2
        if not l2:
            return l1
        n1 = n2 = 0
        p = 0 # will maintain a power of 10 to get digits of the sum in forward order
		
		# just build n1 and n2
        while l1 and l2:
            n1 = 10*n1 + l1.val
            n2 = 10*n2 + l2.val
            l1 = l1.next
            l2 = l2.next
            p += 1
        while l1:
            n1 = 10*n1 + l1.val
            l1 = l1.next
            p += 1
        while l2:
            n2 = 10*n2 + l2.val
            l2 = l2.next
            p += 1
			
		# integer sum, O(1) space
        s = n1 + n2
		
		# dummy head 
        res = dummy = ListNode(0)
		
		# build result in forward order by getting the first digit by dividing by 10**p, p obtained before
        while p >= 0:
            q = 10**p
            res.next = ListNode(s//q)
            res = res.next
            s = s % q
            p -= 1
        dummy = dummy.next
		# p might have been one past necessary, in which case there will be a second 0 after the dummy head
		# e.g. 5 + 1 = 6, p = 1, but 5 // 10 == 0, after that 5 // 1 = 5
        return dummy if dummy.val else dummy.next