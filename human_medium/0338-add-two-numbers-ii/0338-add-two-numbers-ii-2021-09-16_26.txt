# Definition for singly-linked list.
# class ListNode:
#     def __init__(self, val=0, next=None):
#         self.val = val
#         self.next = next
class Solution:
    def addTwoNumbers(self, l1: Optional[ListNode], l2: Optional[ListNode]) -> Optional[ListNode]:
        
        # find the length of lists
        len1, len2, k = 0, 0, 0
        current = l1 
        while current:
            len1 += 1
            current = current.next
        
        current = l2
        while current:
            len2 += 1
            current = current.next
            
        
        # padding the shorter list
        if len1 < len2:
            # pad l1
            l1 = self.padlist(l1, len2-len1)
            k = len2
        elif len2 < len1:
            # pad l2
            l2 = self.padlist(l2, len1-len2)
            k = len1
        else:
            k = len1
            
        
        # implement a recursive function
        # start with its definition
        sum = []
        carry = [0]
        result, carry = self.partialSum(l1, l2, sum, carry)
        
        if len(carry) == k + 1 and carry[-1] == 1:
            result.append(1)
        
        # create a new linkedlist
        return self.createlist(result)
    
    
    def padlist(self, llist, n):
        while n > 0:
            node = ListNode(0)
            node.next = llist
            llist = node
            n -= 1
        return llist
    
    
    def partialSum(self, l1, l2, sum, carry):
        if not l1 and not l2:
            return 
        
        self.partialSum(l1.next, l2.next, sum, carry)
        data = l1.val + l2.val + carry[-1]
        mod = data % 10
        carry.append(int(data/10))
        sum.append(mod)
        return sum, carry
        
        
    def createlist(self, result):
        res = ListNode(result[0])
        for i in result[1:]:
            node = ListNode(i)
            node.next = res
            res = node
        return res