class Solution:
    def deleteNode(self, root: TreeNode, key: int) -> TreeNode:
        root = self.delete_node_tree(root, key)
        return root
            
    def delete_node_tree(self, root, key):
        if not root:
            return None       
        if root.val > key:
            root.left = self.delete_node_tree(root.left, key)
        elif root.val < key:
            root.right = self.delete_node_tree(root.right, key)
        else:
            if root.left == None:
                return root.right
            if root.right == None:
                return root.left
            replace_node = root.right
            par = root
            while(replace_node.left):
                par = replace_node
                replace_node = replace_node.left
            replace_node.left = root.left
            if par != root:
                par.left = replace_node.right
                replace_node.right = root.right
            root = replace_node
        return root