# Definition for a binary tree node.
# class TreeNode:
#     def __init__(self, val=0, left=None, right=None):
#         self.val = val
#         self.left = left
#         self.right = right
class Solution:
    def findNode(self, node, key, parent):
        if node == None:
            return None, None
        if node.val == key:
            return node, parent
        
        if node.val < key:
            return self.findNode(node.right,key,node)
        
        return self.findNode(node.left,key,node)
        
        
    def deleteNode(self, root: TreeNode, key: int) -> TreeNode:
        node = root
        foundNode, parentNode = self.findNode(node,key, None)
        
        if foundNode == None:
            return root
        
        # leaf node
        if foundNode.left == None and foundNode.right == None :
            if parentNode == None:
                return None
            if parentNode.left != None and parentNode.left.val == foundNode.val:
                parentNode.left = None
            elif parentNode.right.val == foundNode.val:
                parentNode.right = None
        
        #has left element
        elif foundNode.left != None:
            node, parent = self.closestNode(foundNode.left, foundNode, "Right")
            
            # if the left has no right
            if parent == foundNode:
                foundNode.val = node.val
                foundNode.left = node.left
            else :
                parent.right = node.left
                foundNode.val = node.val
        
        #has right element
        elif foundNode.right != None:
            node, parent = self.closestNode(foundNode.right, foundNode, "Left")
            
            # if the right has no left
            if parent == foundNode:
                foundNode.val = node.val
                foundNode.right = node.right
            else :
                parent.left = node.right
                foundNode.val = node.val
        
        return root
        
    def closestNode(self, node, parent, side):
        if side == "Left" :
            if node.left == None:
                return node,parent
            else :
                return self.closestNode(node.left,node,side)
        else :
            if node.right == None:
                return node,parent
            else :
                return self.closestNode(node.right,node,side)