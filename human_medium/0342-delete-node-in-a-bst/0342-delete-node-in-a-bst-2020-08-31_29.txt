class Solution:
    def deleteNode(self, root: TreeNode, key: int) -> TreeNode:
        
        def find_delete(node=root, val=key):
            \'\'\'finds and deletes the node with a key, fixing the references\'\'\'
            if not node:
                return None
            elif node.val == val:
                new_node = pop_max(node.left)
                if not new_node:
                    new_node = node.right
                else:
                    new_node.right = node.right
                    if new_node != node.left:
                        new_node.left = node.left
                return new_node
            elif node.val > val:
                node.left = find_delete(node.left, val)
                return node
            else:
                node.right = find_delete(node.right, val)
                return node
        
        def pop_max(node):
            \'\'\'finds and pops the max node, fixing the references\'\'\'
            if not node:
                return node
            maxchild = pop_max(node.right)
            if not maxchild:
                maxchild = node
            elif maxchild == node.right:
                node.right = maxchild.left
            return maxchild
        
        return find_delete()