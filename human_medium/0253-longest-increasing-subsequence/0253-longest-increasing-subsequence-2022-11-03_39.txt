class BITNode:
    def __init__(self, val):
        self.val = val
    def __add__(self, other):
        if self.val < other.val:
            self.val = other.val
        return self

class FenwickTree:
    def __init__(self, n):
        self.n = n
        self.bits = [BITNode(0) for _ in range(self.n + 1)]
    def update(self, index, val):
        i = index + 1
        while i <= self.n:
            self.bits[i] += val
            i += (i & -i)
    def query(self, index):
        i = index
        res = BITNode(0)
        while i:
            res += self.bits[i]
            i -= (i & -i)
        return res
    
class Solution:
    def lengthOfLIS(self, nums: List[int]) -> int:
        _mapping = {val:ind for ind, val in enumerate(sorted(set(nums)))}
        ranks = [_mapping[val] for val in nums]
        res = BITNode(0)
        tree = FenwickTree(2500)
        for rank in ranks:
            cur = tree.query(rank)
            cur.val += 1
            res += cur
            tree.update(rank, cur)
        return res.val