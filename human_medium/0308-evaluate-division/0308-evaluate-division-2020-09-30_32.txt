class UnionFind:
    def __init__(self):
        self.rank = dict()
        self.parent = dict()
        self.elements = set()
        self.values = dict()
        
    def find(self, s):
        if s not in self.elements:
            self.rank[s] = 1
            self.elements.add(s)
            self.parent[s] = s
            self.values[s] = 1
        if self.parent[s] != s:
            self.parent[s] = self.find(self.parent[s])
        return self.parent[s]
    
    def union(self, s1, s2, v):
        r1, v1 = self.find(s1), self.values[s1]
        r2, v2 = self.find(s2), self.values[s2]
        if r1 == r2:
            return
        if self.rank[s2] > self.rank[s1]:
            r1, r2 = r2, r1
            v1, v2 = v2, v1
            v = 1/v
        value = v*v1/v2
        self.parent[r2] = r1
        if self.rank[s1] == self.rank[s2]:
            self.rank[s1] += 1
        self.values[r2] = value
        for e in self.elements:
            if self.parent[e] == r2:
                self.parent[e] = r1
                self.values[e] *= value
        

class Solution:
    def calcEquation(self, equations: List[List[str]], values: List[float], queries: List[List[str]]) -> List[float]:
        uf = UnionFind()
        for idx, (dividend, divisor) in enumerate(equations):
            uf.union(dividend, divisor, values[idx])
        ans = []
        for dividend, divisor in queries:
            if dividend not in uf.elements or divisor not in uf.elements or uf.find(dividend) != uf.find(divisor):
                ans.append(-1)
            else:
                ans.append(uf.values[divisor]/uf.values[dividend])
        print(uf.parent, uf.values)
        return ans