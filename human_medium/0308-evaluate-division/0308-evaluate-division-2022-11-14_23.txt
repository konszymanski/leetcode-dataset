from math import inf


class Solution:
    def bellman_ford(
        self, edges: list[tuple[str, str, float]], nodes: set[str], start: str, end: str
    ) -> float:
        distances = {n: inf for n in nodes}
        distances[start] = 1

        for _ in range(len(nodes) - 1):
            for a, b, w in edges:
                distances[b] = min(distances[b], distances[a] * w)

        return distances[end] if distances[end] != inf else -1

    def calcEquation(
        self, equations: list[list[str]], values: list[float], queries: list[list[str]]
    ) -> list[float]:
        edges = []
        nodes = set()

        for eq, w in zip(equations, values):
            a, b = eq
            edges.append((a, b, w))
            edges.append((b, a, 1 / w))
            nodes.add(a)
            nodes.add(b)

        results = []

        for a, b in queries:
            if a in nodes and b in nodes:
                results.append(self.bellman_ford(edges, nodes, a, b))
            else:
                results.append(-1.0)

        return results