class Solution:
    def integerBreak(self, n: int) -> int:
        # to max product, try to break into k similar-sized pieces
        def build_pieces( k ):
            if k < 2:
                return None
            # k >= 2
            div, mod = divmod(n,k)
            pieces = [div] * k
            while mod >0:
                pieces[mod] += 1 # spread the residule evenly
                mod -= 1
            return pieces

        def product( nums ):
            ans = 1
            for num in nums:
                ans *= num
            return ans
        
        ans = 0
        for k in range(2, n+1):
            pieces = build_pieces( k ) # for debug purpose
            ans = max(ans, product( pieces ) )
        return ans