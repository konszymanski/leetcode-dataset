class Solution:
    def searchMatrix(self, matrix, target):
        # Overall time complexity: O(min(m,n) log (max(m,n) / min(n,n))); binary Saddleback search
        # Overall space complexity: O(1)
        m = len(matrix)
        n = len(matrix[0])
        flipped = False
        
        if m > n:
            m, n = n, m
            flipped = True
        
        def search_rectangle(i1, j1, i2, j2):
            if i1 < 0 or i1 >= m or j1 < 0 or j1 >= n or i2 < 0 or i2 >= m or j2 < 0 or j2 >= n:
                return False
            elif i1 > i2 or j1 > j2:
                return False
            
            row = (i1 + i2) // 2
            
            start = j1
            end = j2
            while start <= end:
                mid = (start + end) // 2
                if flipped and matrix[mid][row] == target:
                    return True
                if not flipped and matrix[row][mid] == target:
                    return True
                
                if flipped:
                    if matrix[mid][row] < target:
                        start = mid + 1
                    else:
                        end = mid - 1
                elif not flipped:
                    if matrix[row][mid] < target:
                        start = mid + 1
                    else:
                        end = mid - 1
            
            lb = start - 1
            ub = start
            
            return search_rectangle(i1, ub, row - 1, j2) or search_rectangle(row + 1, j1, i2, lb)        
    
        return search_rectangle(0, 0, m - 1, n - 1)