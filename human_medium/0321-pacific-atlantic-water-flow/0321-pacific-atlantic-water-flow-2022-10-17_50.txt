class Solution:
    def pacificAtlantic(self, heights: List[List[int]]) -> List[List[int]]:
        if not heights or not heights[0]: 
            return []
        
        nrows = len(heights)
        ncols = len(heights[0])
        visited = set()
        
        def dfs(r,c,ocean):
            nonlocal visited
            
            # Return True if it reaches leftmost col or topmost row for Pacific Ocean only
            if (r == 0 or c == 0) and ocean == 0:
                return True
            # Return True if it reaches rightmost col or bottommost row for Atlantic Ocean only
            if (r == nrows-1 or c == ncols-1) and ocean == 1:
                return True
            if r < 0 or r >= nrows or c < 0 or c >= ncols:
                return False
            
            visited.add((r,c))
            
            height = heights[r][c]
            for rowOffset, colOffset in [(0, 1), (-1, 0), (0, -1), (1, 0)]:
                new_row = r + rowOffset
                new_col = c + colOffset
                if new_row >= 0 and new_row < nrows and new_col >= 0 and new_col < ncols and (new_row,new_col) not in visited:
                    neighbor_height = heights[new_row][new_col]
                    if neighbor_height <= height and dfs(new_row, new_col,ocean):
                        return True

            return False
                
        # 0 - Pacific 
        # 1 - Atlantic
        res = []
        for row in range(nrows):
            for col in range(ncols):
                # Reset visited for every dfs
                visited = set()
                if dfs(row,col,0):
                    visited = set()
                    if dfs(row,col,1):
                        res.append((row,col))
                    
        return res