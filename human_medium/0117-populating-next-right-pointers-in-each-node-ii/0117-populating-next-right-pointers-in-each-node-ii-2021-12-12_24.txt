# Definition for a Node.
from typing import Optional


class Node:
    def __init__(self, val: int = 0, left: \'Node\' = None, right: \'Node\' = None, next: \'Node\' = None):
        self.val = val
        self.left = left
        self.right = right
        self.next = next


class Solution:
    def connect(self, root: Optional[Node]) -> Optional[Node]:

        current_level_node = root

        while current_level_node:

            next_level_current_node = next_level_head_node = Node(0)

            while current_level_node:

                if current_level_node.left:
                    next_level_current_node.next = current_level_node.left
                    next_level_current_node = current_level_node.left

                if current_level_node.right:
                    next_level_current_node.next = current_level_node.right
                    next_level_current_node = current_level_node.right

                current_level_node = current_level_node.next

            current_level_node = next_level_head_node.next

        return root