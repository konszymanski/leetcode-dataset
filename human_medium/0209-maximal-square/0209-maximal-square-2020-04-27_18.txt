class Solution:
    def maximalSquare(self, matrix: List[List[str]]) -> int:
        
        @lru_cache(None)
        def fn(i, j): 
            """Return length of max square ending at (i, j)"""
            if i < 0 or j < 0 or matrix[i][j] == "0": return 0
            return 1 + min(fn(i-1, j), fn(i-1, j-1), fn(i, j-1))
        
        return max((fn(i, j) for i in range(len(matrix)) for j in range(len(matrix[0]))), default=0)**2