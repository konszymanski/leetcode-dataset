class Solution:
    def maximalSquare(self, matrix: List[List[str]]) -> int:
        i = 0
        rows = len(matrix)
        cols = len(matrix[0])
        temp = [0 for x in range(cols)]
        def maxAns():
            ans = 0
            for i in range(rows):
                for j in range(cols):
                    if int(matrix[i][j]):
                        temp[j] += int(matrix[i][j])
                    else:
                        temp[j] = 0
                print(temp)
                ans = max(ans , maxSquare(temp))
            return ans
        
        def maxSquare(arr):
            temp = 0 
            ls = []
            rs = []

            # ls is an array which contains the index of first element smaller than current towards left.
			
            i = 0
            stack = []
            while i < cols:
                num = arr[i]
                while stack and stack[-1][0] >=num:
                    stack.pop()
                if stack:
                    ls.append(stack[-1][1])
                else:
                    ls.append(-1)
                stack.append([num , i])
                i+=1
            
            # rs is an array which contains the first index towards right of the element which is smaller than current element.
             
            stack = []
            i = cols - 1
            while i >= 0:
                num = arr[i]
                while stack and stack[-1][0] >= num:
                    stack.pop()
                    
                if stack:
                    rs.append(stack[-1][1])
                else:
                    rs.append(cols)
                stack.append([num , i])
                i-=1
            
            rs = rs[::-1]
			
			# logic of finding max area square, we are looking for max area rectangles and then using the smaller side calculating area for square.
            i = 0
            while i < cols:
                temp = max(temp , min(rs[i] - ls[i] - 1 , arr[i])**2 )
                i+=1
            return temp

                  
        return maxAns()