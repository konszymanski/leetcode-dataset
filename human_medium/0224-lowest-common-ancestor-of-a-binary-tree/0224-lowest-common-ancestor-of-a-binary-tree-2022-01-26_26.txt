class Solution:
    def lowestCommonAncestor(self, root: \'TreeNode\', p: \'TreeNode\', q: \'TreeNode\') -> \'TreeNode\':
        """
        Do a depth first traversal.
        
        We check it using the following logic:
        - if the current node is either p,q it must be part of the LCA subtree.
        - recursively check the left and right nodes.
        - split into four cases:
        - if it is found in the left AND right, then it is an ancestor.
        - if it found only on the left, return left
        - if it found only on the left, return left
        - otherwise it is not part of the LCA
        
        These are all passed recursively up the tree.
        """
        
        def dfs(node = None):
            if not node:
                return None
            
            if node in [p, q]:
                return node
    
            left = dfs(node.left)
            right = dfs(node.right)
        
            # was found in left AND right, this node is a ancestor
            if (left and right):
                return node
            elif left:
                return left
            elif right:
                return right
            else:
                return None
        
        return dfs(root)